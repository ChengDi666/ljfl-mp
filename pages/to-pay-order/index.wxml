<view class="container">
  <view class="goods-list">
    <view class="list-title">商品列表</view>
    <view class="a-goods" wx:for="{{goodsList}}" wx:key="{{index}}">
      <view class="img-box">
        <image src="{{item.pic}}" class="img" />
      </view>
      <view class="text-box">
        <view class="arow arow01">
          <view class="goods-name">{{item.name}}</view>
          <view style="text-align: right;" class="goods-price">积分: {{item.score}}<view style="font-size: 23rpx">¥ {{item.price}} </view></view>
        </view>
        <view class="arow">
          <view class="goods-label">
            {{item.label}}
            <block wx:for="{{item.sku}}" wx:for-item="option" wx:key="index">
              {{option.optionName}}:{{option.optionValueName}}
            </block>
          </view>
          <view class="goods-num">x {{item.number}}</view>
        </view>
      </view>
    </view>
  </view>
  <view class="peisong-way">
    <view class="row-box" wx:if="{{isNeedLogistics > 0}}">
      <view class="row-label">配送方式</view>
      <radio-group bindchange="radioChange">
        <label class="radio">
          <radio value="kd" checked="{{peisongType == 'kd'}}" /> 快递
        </label>
        <label class="radio" wx:if='{{allowSelfCollection == "1"}}'>
          <radio value="zq" checked="{{peisongType == 'zq'}}" /> 到店自取
        </label>
      </radio-group>
    </view>
    <view class="address-box" wx:if="{{peisongType == 'kd' && isNeedLogistics > 0}}">
      <view class="add-address" hidden="{{curAddressData}}" bindtap="addAddress">
        <image src="/images/add-addr.png"></image>
        <view>新增收货地址</view>
      </view>
      <view class="show-address" hidden="{{!curAddressData}}" bindtap="selectAddress">
        <view class="l">
          <view class="name-tel">{{curAddressData.linkMan}} {{curAddressData.mobile}}</view>
          <view class="addr-text">{{curAddressData.address}}</view>
        </view>
        <view class="r">
          <image class="next" src="/images/icon/next.png"></image>
        </view>
      </view>
    </view>
    <view class="row-box">
      <view class="row-label">备注</view>
      <view class="right-text">
        <input bindinput="remarkChange" type="text" class="liuyan" placeholder="如需备注请输入" />
      </view>
    </view>
  </view>
  <view class="peisong-way" hidden="{{hasNoCoupons}}">
    <view class="row-box" style="border-bottom:none;">
      <view class="row-label t">使用优惠券</view>
    </view>
    <picker bindchange="bindChangeCoupon" range="{{coupons}}" range-key="nameExt">
      <view class="row-box" style="border-bottom:none;">      
        <view class="row-label">{{curCouponShowText}}</view>
        <image class="next" src="/images/icon/next.png"></image>
      </view>
    </picker>
  </view>


  <view class="goods-info" style="margin-bottom: 20rpx;">
    <view class="row-box">
      <view class="row-label">我的积分</view>
      <view class="right-text">{{user_score}}</view>
    </view>
    <view class="row-box" wx:if="{{user_score < totalScoreToPay}}" >
      <view class="row-label">是否使用金钱补足：</view>
      <switch checked="{{switchChecked}}" bindchange="switch1Change"/>
    </view>
  </view>

  <view class="goods-info">
    <view class="row-box">
      <view class="row-label">商品</view>
      <view class="right-text" wx:if="{{switchChecked}}">积分：{{totalScoreToPay - user_score}} = ¥ {{(user_score - totalScoreToPay)*(-1)/100}}
        <view style="font-size: 21rpx; color: #999;">100 积分 = 1 元人民币</view>
      </view>
      <view class="right-text" wx:if="{{!switchChecked}}">积分： {{totalScoreToPay}}</view>
    </view>
    <view class="row-box" wx:if="{{isNeedLogistics > 0}}">
      <view class="row-label">运费</view>
      <view class="right-text">+ ¥ {{yunPrice}}</view>
    </view>
    <view class="row-box" wx:if="{{!hasNoCoupons}}">
      <view class="row-label">优惠券</view>
      <view class="right-text">- ¥ {{youhuijine}}</view>
    </view>
  </view>

  <view class="jiesuan-box safeAreaOldPaddingBttom safeAreaNewPaddingBttom">
    <view class="left-price">
      <view class="total" wx:if="{{switchChecked}}">合计： 积分 {{user_score}} + ¥ {{(totalScoreToPay - user_score)/100}}<text wx:if="{{yunPrice > 0}}"> + {{yunPrice}}</text></view>
      <view class="total" wx:if="{{!switchChecked}}">合计： 积分 {{totalScoreToPay}}<text wx:if="{{yunPrice > 0}}"> + ¥ {{yunPrice}}</text></view>
    </view>
    <button class="to-pay-btn" bindtap="goCreateOrder">提交订单</button>
  </view>
</view>

<import src="/template/login/index.wxml" />
<template is="apifmLogin" data="{{wxlogin: wxlogin}}" />